<div>
    <div class="w3-row-padding">
        <div class="w3-col">
            <material-toggle class="w3-right" [label]="timelineLabel" (checkedChange)="timelineVisible = $event"></material-toggle>
        </div>
    </div>
    <div class="w3-row-padding">
        <div class="w3-col" style="width:{{mainColWidth}}">
            <material-expansionpanel
                    [alwaysHideExpandIcon]="true"
                    [hideExpandedHeader]="false"
                    [showSaveCancel]="false"
                    [expanded]="true"
                    [disabled]="true">
                <!-- div name and value are the same to WorksComponent -->
                <div name class="custom-expansionpanel-panel-specific-name-width">
                    <span class="truncate-ellipsed-parent">
                        <span class="truncate-ellipsed"><strong>{{work.name}}</strong></span>
                        <div class="truncate-ellipsed">{{work.description}}</div>
                    </span>
                </div>
                <div class="w3-row" value>
                    <div class="w3-col m9">
                        <div class="custom-grid-vertical">
                            <auge-work-summary [work]="work"></auge-work-summary>
                        </div>
                    </div>
                    <div class="w3-col m3">
                        <div class="custom-grid w3-right">
                            <div class="truncate-parent">
                                <div *ngIf="work.group != null" class="avatar avatar-border margin-bottom" [style.background-color]="colorFromUuid(work.group?.id)" [materialTooltip]="composeTooltip(groupLabel, work.group?.name)">
                                    <span class="text-group-letter">{{firstLetter(work.group?.name)}}</span>
                                </div>
                                <div *ngIf="work.group == null" class="avatar margin-bottom"></div>
                                <div *ngIf="work.leader != null" class="avatar margin-top" [style.background-image]="'url(' +  userUrlImage(work.leader) + ')'" [materialTooltip]="composeTooltip(leaderLabel, work.leader?.name)"></div>
                                <div *ngIf="work.leader == null" class="avatar margin-top"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container-flex-row">
                    <div *ngFor="let kanbanColumn of kanbanColumns" class="column-divider">
                        <div (drop)="drop($event, kanbanColumn)" (dragover)="allowDrop($event)" class="items-column">
                            <header [style.background-color]="'hsl(' + stateHslColor(kanbanColumn.workStage.state) + ')'">
                                <h7><strong>{{kanbanColumn.workStage.name}}</strong></h7>
                                <material-button class="w3-right" icon (trigger)="selectWorkItem(null);goToDetail(kanbanColumn.workStage.id)">
                                    <material-icon icon="add"></material-icon>
                                </material-button>
                            </header>
                            <material-expansionpanel-set>
                                <span *ngFor="let iColumnWorkItem of kanbanColumn.columnWorkItems">
                                    <div class="column-stage" draggable="true" (dragstart)="drag($event, kanbanColumn, iColumnWorkItem)" >
                                        <material-expansionpanel class="panel-name-max-width shadow"
                                                                 [disabled]="true"
                                                                 [expanded]="true"
                                                                 [hideExpandedHeader]="false"
                                                                 [alwaysHideExpandIcon]="true"
                                                                 [showSaveCancel]="false">
                                            <!-- div name class="custom-expansionpanel-panel-specific-name-width" -->
                                            <div name>
                                                <span class="name-ellipse">
                                                    {{iColumnWorkItem.name}}
                                                </span>
                                                <!-- span class="w3-col l12 truncate-ellipsed-parent">
                                                    <span class="truncate-ellipsed">{{iColumnWorkItem.name}}</span>
                                                </span>
                                                <span class="w3-col l12 w3-right" *ngFor="let member of iColumnWorkItem.assignedTo">&nbsp;
                                                    <span class="avatar" [style.background-image]="'url(' +  userUrlImage(member)  + ')'" [materialTooltip]="member.name"></span>
                                                </span -->

                                            </div>
                                            <!-- class="w3-col l12 w3-right"  -->
                                            <div value class="w3-right-align">
                                                <span *ngFor="let member of iColumnWorkItem.assignedTo">
                                                    <span class="avatar-icon" [style.background-image]="'url(' +  userUrlImage(member)  + ')'" [materialTooltip]="member.name"></span>
                                                </span>
                                                <div>
                                                    <span materialTooltip="{{dueDateLabel}}" [style.color]="dueDateColor(iColumnWorkItem)">{{iColumnWorkItem.dueDate | date:'shortDate'}}</span>
                                                </div>
                                            </div>

                                            <!-- div value>
                                                <div class="w3-row-padding">
                                                <span class="w3-col l2">
                                                    {{iColumnWorkItem.completed}}%
                                                </span>
                                                    <span class="w3-col l10">
                                                    <material-slider [(value)]="iColumnWorkItem.completed"
                                                                     [min]="0"
                                                                     [max]="100"
                                                                     materialTooltip="{{completedLabel}}" (click)="updateWorkItem(iColumnWorkItem)">
                                                    </material-slider>
                                                </span>
                                                </div>
                                                <div class="w3-row-padding">
                                                <span class="w3-col l12">
                                                    <span materialTooltip="{{dueDateLabel}}" [style.color]="dueDateColor(iColumnWorkItem)">{{iColumnWorkItem.dueDate | date}}</span>
                                                </span>
                                                </div>
                                                <div class="w3-row w3-col l12">
                                                    <material-expansionpanel *ngIf="iColumnWorkItem.checkItems.length > 0" name="{{checkItemsLabel}}" autoDismissable [showSaveCancel]="false" class="expansionpanel-flat-on-collapse-theme-no-border">
                                                        <div *deferredContent>
                                                            <div *ngFor="let iCheckItem of iColumnWorkItem.checkItems">
                                                                <material-checkbox class="width-200" [(ngModel)]="iCheckItem.finished" [label]="iCheckItem.name" (click)="updateWorkItem(iColumnWorkItem)"></material-checkbox>
                                                            </div>
                                                        </div>
                                                    </material-expansionpanel>
                                                </div>
                                            </div -->
                                            <div action>
                                                <material-menu [menu]="menuModel" (click)="selectWorkItem(iColumnWorkItem);disEnableItemMenuActual()">
                                                </material-menu>
                                            </div>

                                            <!-- div value>
                                                <div class="w3-row-padding">
                                                <span class="w3-col l2">
                                                    {{iColumnWorkItem.completed}}%
                                                </span>
                                                    <span class="w3-col l10">
                                                    <material-slider [(value)]="iColumnWorkItem.completed"
                                                                     [min]="0"
                                                                     [max]="100"
                                                                     materialTooltip="{{completedLabel}}" (click)="updateWorkItem(iColumnWorkItem)">
                                                    </material-slider>
                                                </span>
                                                </div>
                                                <div class="w3-row-padding">
                                                <span class="w3-col l12">
                                                    <span materialTooltip="{{dueDateLabel}}" [style.color]="dueDateColor(iColumnWorkItem)">{{iColumnWorkItem.dueDate | date}}</span>
                                                </span>
                                                </div>
                                                <div class="w3-row w3-col l12">
                                                    <material-expansionpanel *ngIf="iColumnWorkItem.checkItems.length > 0" name="{{checkItemsLabel}}" autoDismissable [showSaveCancel]="false" class="expansionpanel-flat-on-collapse-theme-no-border">
                                                        <div *deferredContent>
                                                            <div *ngFor="let iCheckItem of iColumnWorkItem.checkItems">
                                                                <material-checkbox class="width-200" [(ngModel)]="iCheckItem.finished" [label]="iCheckItem.name" (click)="updateWorkItem(iColumnWorkItem)"></material-checkbox>
                                                            </div>
                                                        </div>
                                                    </material-expansionpanel>
                                                </div>
                                            </div -->
                                            <div>
                                                <div *ngIf="hasPlannedOrActual(iColumnWorkItem)">
                                                    <div class="w3-center">
                                                        <span class="w3-left">
                                                            {{iColumnWorkItem.plannedValue}}
                                                        </span>
                                                        <span class="w3-center">
                                                            {{iColumnWorkItem.actualValue}}
                                                        </span>
                                                        <span class="w3-right">
                                                            {{remainingValue(iColumnWorkItem.plannedValue, iColumnWorkItem.actualValue)}}
                                                        </span>
                                                    </div>
                                                    <div>
                                                        <material-slider [disabled]="whileUpdatingDisabled" [(value)]="iColumnWorkItem.actualValue"
                                                                         [min]="0"
                                                                         [max]="100"
                                                                         materialTooltip="{{actualValueLabel}}" (click)="goToValues(iColumnWorkItem)">
                                                        </material-slider>
                                                    </div>
                                                </div>
                                                <material-expansionpanel *ngIf="iColumnWorkItem.checkItems.length > 0" name="{{checkItemsLabel}}" [(expanded)]="checkItensExpandedControl[iColumnWorkItem.id]"  [showSaveCancel]="false" class="no-border">
                                                    <div>
                                                        <div *ngFor="let iCheckItem of iColumnWorkItem.checkItems">
                                                            <material-checkbox [disabled]="whileUpdatingDisabled" [(ngModel)]="iCheckItem.finished" [label]="iCheckItem.name" (click)="updateWorkItem(iColumnWorkItem)"></material-checkbox>
                                                        </div>
                                                    </div>
                                                </material-expansionpanel>
                                            </div>
                                        </material-expansionpanel>
                                    </div>
                                </span>
                            </material-expansionpanel-set>
                        </div>
                    </div>
                </div>
            </material-expansionpanel>
         </div>
        <div *ngIf="timelineVisible == true" class="w3-col w3-right" style="width:25%">
            <auge-history-timeline></auge-history-timeline>
        </div>
    </div>
</div>
<router-outlet [routes]="routes"></router-outlet>